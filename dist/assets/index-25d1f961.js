var E=Object.defineProperty;var T=(n,e,t)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var x=(n,e,t)=>(T(n,typeof e!="symbol"?e+"":e,t),t);import{r as w,a as M,b as j,m as O,C as R,L as k,S as C,c as m,B as z,t as A,R as F}from"./common-15510848.js";import{l as I,e as N}from"./editor-297099d6.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var B={exports:{}},_={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D=w,P=Symbol.for("react.element"),$=Symbol.for("react.fragment"),U=Object.prototype.hasOwnProperty,V=D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,H={key:!0,ref:!0,__self:!0,__source:!0};function L(n,e,t){var i,a={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)U.call(e,i)&&!H.hasOwnProperty(i)&&(a[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)a[i]===void 0&&(a[i]=e[i]);return{$$typeof:P,type:n,key:s,ref:o,props:a,_owner:V.current}}_.Fragment=$;_.jsx=L;_.jsxs=L;B.exports=_;var r=B.exports,S={},W=M;S.createRoot=W.createRoot,S.hydrateRoot=W.hydrateRoot;function G(){return new Worker("/assets/editor.worker-d485f108.js")}function q(){return new Worker("/assets/json.worker-90203a43.js")}function J(){return new Worker("/assets/css.worker-36c43e0d.js")}function K(){return new Worker("/assets/html.worker-7356b7be.js")}function Q(){return new Worker("/assets/ts.worker-8981a67d.js")}self.MonacoEnvironment={getWorker(n,e){return e==="json"?new q:e==="css"||e==="scss"||e==="less"?new J:e==="html"||e==="handlebars"||e==="razor"?new K:e==="typescript"||e==="javascript"?new Q:new G}};I.typescript.typescriptDefaults.setEagerModelSync(!0);const{defaultAlgorithm:Y,darkAlgorithm:X}=A,{Header:Z,Content:ee}=k,g=()=>window.matchMedia("(prefers-color-scheme: dark)").matches;function te(n){const e=N.create(n.dom,{readOnly:!1,language:"json",theme:g()?"vs-dark":"vs",automaticLayout:!0});return e.updateOptions({fontSize:14,lineNumbersMinChars:4,wordWrap:"on"}),e}const ae=n=>{let e="rgb(0, 0, 0)";return n&&(e="rgb(255, 255, 255)"),r.jsx("a",{href:"https://github.com/vicanso/charts-rs",style:{},children:r.jsx("svg",{height:"32",viewBox:"0 0 16 16",width:"32","aria-hidden":"true",style:{display:"block",marginLeft:"15px",fill:e},children:r.jsx("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"})})})},b=[{value:"barBasic",label:"Bar: 常规柱状图"},{value:"lineBasic",label:"Line: 常规曲线图"},{value:"lineStartIndexBasic",label:"Line: 指定开始点曲线图"},{value:"lineSmooth",label:"Line: 常规平滑曲线图"},{value:"lineSmoothFill",label:"Line: 填充平滑曲线图"},{value:"barLineMixin",label:"BarLine: 柱线混合图"},{value:"horizontalBar",label:"HorizontalBar: 水平柱状图"},{value:"pieBasic",label:"Pie: 饼图"},{value:"radarBasic",label:"Radar: 雷达图"},{value:"scatterBasic",label:"Scatter: 散点图"},{value:"tableBasic",label:"Table: 表格"}],y=[{value:"grafana",label:"Grafana"},{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"ant",label:"Ant"}],v=[{value:"svg",label:"SVG"},{value:"png",label:"PNG"}],d={quality:80,width:600,height:400,margin:{left:5,top:5,right:5,bottom:5},font_family:"Roboto",title_font_size:18,title_font_weight:"bold",title_margin:{left:0,top:0,right:0,bottom:0},title_align:"center",title_height:30,sub_title_text:"Sub Title",sub_title_font_size:14,sub_title_margin:{left:0,top:0,right:0,bottom:0},sub_title_align:"center",sub_title_height:20,legend_font_size:14,legend_align:"center",legend_margin:{left:0,top:0,right:0,bottom:0},legend_category:"normal",legend_show:!0,x_axis_height:30,x_axis_font_size:14,x_axis_name_gap:5,x_axis_name_rotate:0,x_boundary_gap:!0,x_axis_margin:{left:0,top:0,right:0,bottom:0}},ie={barBasic:Object.assign({},d,{type:"bar",title_text:"Bar Chart",legend_align:"left",x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series_list:[{name:"Email",label_show:!0,data:[120,132,101,134,90,230,210]},{name:"Union Ads",label_show:!0,data:[220,182,191,234,290,330,310]}]}),lineBasic:Object.assign({},d,{type:"line",title_text:"Line Chart",legend_align:"right",x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],x_boundary_gap:!1,margin:{left:15,top:15,right:15,bottom:15},series_list:[{name:"Email",label_show:!0,data:[120,132,101,134,90,230,210]},{name:"Union Ads",label_show:!0,data:[220,182,191,234,290,330,310]}]}),lineStartIndexBasic:Object.assign({},d,{type:"line",title_text:"Line Chart",legend_align:"right",x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],x_boundary_gap:!1,margin:{left:15,top:15,right:15,bottom:15},series_list:[{name:"Email",label_show:!0,data:[120,132,101,134,90,230,210]},{name:"Union Ads",label_show:!0,start_index:1,data:[182,191,234,290,330,310]}]}),lineSmooth:Object.assign({},d,{type:"line",title_text:"Line Smooth Chart",legend_align:"right",x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series_smooth:!0,series_list:[{name:"Email",label_show:!0,data:[120,132,101,134,90,230,210]},{name:"Union Ads",label_show:!0,data:[220,182,191,234,290,330,310]}]}),lineSmoothFill:Object.assign({},d,{type:"line",title_text:"Line Smooth Fill Chart",legend_align:"right",x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series_smooth:!0,series_fill:!0,series_list:[{name:"Email",label_show:!0,data:[120,132,101,134,90,230,210]},{name:"Union Ads",label_show:!0,data:[220,182,191,234,290,330,310]}]}),barLineMixin:Object.assign({},d,{type:"bar",title_text:"Bar Line Mixin",sub_title_text:"",legend_margin:{top:25,bottom:3},x_axis_data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series_smooth:!0,y_axis_configs:[{axis_font_size:14,axis_formatter:"{c} ml",axis_min:-5,axis_max:25},{axis_stroke_color:"#EE6666",axis_font_color:"#EE6666",axis_formatter:"{c} °C"}],series_list:[{name:"Evaporation",data:[2,4.9,7,23.2,25.6,76.7,135.6]},{name:"Precipitation",data:[2.6,5.9,9,26.4,28.7,70.7,175.6]},{name:"Temperature",category:"line",y_axis_index:1,label_show:!0,data:[2,2.2,3.3,4.5,6.3,10.2,20.3]}]}),horizontalBar:Object.assign({},d,{type:"horizontal_bar",title_text:"World Population",legend_align:"left",x_axis_data:["Brazil","Indonesia","USA","India","China","World"],series_list:[{name:"2011",label_show:!0,data:[18203,23489,29034,104970,131744,630230]},{name:"2012",label_show:!0,data:[19325,23438,31e3,121594,134141,681807]}]}),pieBasic:Object.assign({},d,{type:"pie",title_text:"Nightingale Chart",legend_margin:{top:50},series_list:[{name:"rose 1",data:[40]},{name:"rose 2",data:[38]},{name:"rose 3",data:[32]},{name:"rose 4",data:[30]},{name:"rose 5",data:[28]},{name:"rose 6",data:[26]},{name:"rose 7",data:[22]},{name:"rose 8",data:[18]}]}),radarBasic:Object.assign({},d,{type:"radar",title_text:"Radar Chart",sub_title_text:"",title_margin:{top:20},series_list:[{name:"Allocated Budget",data:[4200,3e3,2e4,35e3,5e4,18e3]},{name:"Actual Spending",data:[5e3,14e3,28e3,26e3,42e3,21e3]}],indicators:[{name:"Sales",max:6500},{name:"Administration",max:16e3},{name:"Information Technology",max:3e4},{name:"Customer Support",max:38e3},{name:"Development",max:52e3},{name:"Marketing",max:25e3}]}),scatterBasic:Object.assign({},d,{type:"scatter",title_text:"Male and female height and weight distribution",title_align:"left",sub_title_text:"Data from: Heinz 2003",sub_title_align:"left",legend_align:"right",margin:{left:5,top:5,right:20,bottom:5},y_axis_configs:[{axis_min:40,axis_max:130,axis_formatter:"{c} kg"}],x_axis_config:{axis_min:140,axis_max:230,axis_formatter:"{c} cm"},series_list:[{name:"Female",data:[161.2,51.6,167.5,59,159.5,49.2,157,63,155.8,53.6,170,59,159.1,47.6,166,69.8,176.2,66.8,160.2,75.2,172.5,55.2,170.9,54.2,172.9,62.5,153.4,42,160,50,147.2,49.8,168.2,49.2,175,73.2,157,47.8,167.6,68.8,159.5,50.6,175,82.5,166.8,57.2,176.5,87.8,170.2,72.8]},{name:"Male",data:[174,65.6,175.3,71.8,193.5,80.7,186.5,72.6,187.2,78.8,181.5,74.8,184,86.4,184.5,78.4,175,62,184,81.6,180,76.6,177.8,83.6,192,90,176,74.6,174,71,184,79.6,192.7,93.8,171.5,70,173,72.4,176,85.9,176,78.8,180.5,77.8,172.7,66.2,176,86.4,173.5,81.8]}],series_symbol_sizes:[6,6]}),tableBasic:Object.assign({quality:80,width:600,height:400,spans:[.5,.3,.2],text_aligns:["left","center","right"],header_row_padding:{left:10,top:10,right:10,bottom:10},header_row_height:30,header_font_size:16},{type:"table",title_height:45,title_text:"NASDAQ",sub_title_text:"",data:[["Name","Price","Change"],["Datadog Inc","97.32","-7.49%"],["Hashicorp Inc","28.66","-9.25%"],["Gitlab Inc","51.63","+4.32%"]],header_font_weight:"bold",text_aligns:["left","center","right"],cell_styles:[{font_color:"#fff",font_weight:"bold",background_color:"#2d7c2b",indexes:[1,2]}]})};class re extends w.Component{constructor(t){super(t);x(this,"editorInited");x(this,"editorDom");this.editorDom=w.createRef(),this.editorInited=!1,this.state={theme:y[0].value,format:v[0].value,fontFamilies:[],fontFamily:"",editor:null,width:0,height:0,svg:"",png:"",processing:!1}}async componentDidMount(){if(this.editorInited)return;this.editorInited=!0;const t=te({dom:this.editorDom.current});this.setState({editor:t},()=>{this.changeChartOption(b[0].value)});const{data:i}=await j.get("/api/font-families");this.setState({fontFamilies:i.families})}getChartOption(){const{editor:t}=this.state;if(t){const i=t.getValue();try{return JSON.parse(i)}catch(a){O.error(a==null?void 0:a.message)}}}changeChartOption(t){const i=Object.assign({},ie[t]);this.updateChartOption(i)}updateChartOption(t){t.theme=this.state.theme,this.state.fontFamily&&(t.font_family=this.state.fontFamily);const{editor:i}=this.state;i&&i.setValue(JSON.stringify(t,null,2))}refreshChartOption(){this.updateChartOption(this.getChartOption())}async generateChart(){var s;if(this.state.processing)return;const t=this.getChartOption();let i=!0,a="/api/charts/svg";this.state.format=="png"&&(a="/api/charts/png",i=!1);try{this.setState({processing:!0});const o={};i||(o.responseType="arraybuffer");const{data:c}=await j.post(a,t,o);let h="",u="";i?h=c:u=`data:image/png;base64,${btoa(new Uint8Array(c).reduce((f,l)=>f+String.fromCharCode(l),""))}`,this.setState({svg:h,png:u,width:t.width||0,height:t.height||0})}catch(o){let c=o==null?void 0:o.message;const h=o;(s=h==null?void 0:h.response)!=null&&s.data&&(c=h.response.data.message||""),O.error(c||"generate chart fail",10)}finally{this.setState({processing:!1})}}render(){const{svg:t,png:i,width:a,height:s,format:o,processing:c,fontFamilies:h}=this.state;let u="header";g()&&(u+=" dark");const p={position:"absolute",left:"50%",top:"50%",marginTop:`-${s/2}px`,marginLeft:`-${a/2}px`},f=h.map(l=>({label:l,value:l}));return r.jsx(R,{theme:{algorithm:g()?X:Y},children:r.jsxs(k,{children:[r.jsx(Z,{className:u,children:r.jsxs("div",{className:"contentWrapper",children:[r.jsx(C,{children:r.jsx("span",{style:{fontWeight:"bold"},children:"CHARTS-RS"})}),r.jsxs(C,{style:{float:"right"},children:[r.jsx(m,{size:"large",style:{width:150},options:v,defaultValue:v[0].value,onChange:l=>{this.setState({format:l})}}),r.jsx(m,{size:"large",style:{width:150},options:y,defaultValue:y[0].value,onChange:l=>{this.setState({theme:l},()=>{this.refreshChartOption()})}}),r.jsx(m,{size:"large",style:{width:150},defaultValue:"Roboto",options:f,onChange:l=>{this.setState({fontFamily:l},()=>{this.refreshChartOption()})}}),r.jsx(m,{size:"large",style:{width:250},options:b,defaultValue:b[0].value,onChange:l=>{this.changeChartOption(l)}}),r.jsx(z,{size:"large",type:"primary",style:{width:120},onClick:()=>this.generateChart(),children:c?"生成中...":"运行"}),ae(g())]})]})}),r.jsxs(ee,{children:[r.jsx("div",{className:"editorWrapper",ref:this.editorDom}),r.jsxs("div",{className:"previewWrapper",children:[o==="svg"&&r.jsx("div",{style:p,dangerouslySetInnerHTML:{__html:t}}),o!=="svg"&&r.jsx("img",{style:p,src:i})]})]})]})})}}S.createRoot(document.getElementById("root")).render(r.jsx(F.StrictMode,{children:r.jsx(re,{})}));
